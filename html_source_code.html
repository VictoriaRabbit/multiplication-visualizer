<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multiplication Rectangle Visualizer</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { margin: 0; font-family: system-ui, -apple-system, sans-serif; }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;

        // Lucide icons as simple SVG components
        const Play = () => (
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polygon points="5,3 19,12 5,21 5,3"></polygon>
            </svg>
        );
        
        const Pause = () => (
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <rect x="6" y="4" width="4" height="16"></rect>
                <rect x="14" y="4" width="4" height="16"></rect>
            </svg>
        );
        
        const RotateCcw = () => (
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polyline points="1,4 1,10 7,10"></polyline>
                <path d="M3.51,15a9,9,0,0,0,2.13,3.09,9,9,0,0,0,13.37,0,9,9,0,0,0,0-12.76,9,9,0,0,0-9.51-1.85"></path>
            </svg>
        );
        
        const Eye = () => (
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                <circle cx="12" cy="12" r="3"></circle>
            </svg>
        );
        
        const EyeOff = () => (
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path>
                <line x1="1" y1="1" x2="23" y2="23"></line>
            </svg>
        );

        const MultiplicationVisualizer = () => {
            const [num1, setNum1] = useState(4);
            const [num2, setNum2] = useState(6);
            const [isAnimating, setIsAnimating] = useState(false);
            const [currentCount, setCurrentCount] = useState(0);
            const [showNumbers, setShowNumbers] = useState(true);
            const [animationSpeed, setAnimationSpeed] = useState(100);
            const [colorMode, setColorMode] = useState('fill');
            const [isSelecting, setIsSelecting] = useState(false);
            const [selectionEnd, setSelectionEnd] = useState({ row: 0, col: 0 });
            const [isDragging, setIsDragging] = useState(false);

            const maxSize = 50;
            const cellSize = Math.max(15, Math.min(25, 600 / Math.max(num1, num2)));

            useEffect(() => {
                if (isAnimating && currentCount < num1 * num2) {
                    const timer = setTimeout(() => {
                        setCurrentCount(prev => prev + 1);
                    }, animationSpeed);
                    return () => clearTimeout(timer);
                } else if (currentCount >= num1 * num2) {
                    setIsAnimating(false);
                }
            }, [isAnimating, currentCount, num1, num2, animationSpeed]);

            const startAnimation = () => {
                setCurrentCount(0);
                setIsAnimating(true);
            };

            const resetAnimation = () => {
                setIsAnimating(false);
                setCurrentCount(0);
            };

            const toggleAnimation = () => {
                setIsAnimating(!isAnimating);
            };

            const showAll = () => {
                setCurrentCount(num1 * num2);
                setIsAnimating(false);
            };

            const getCellColor = (index) => {
                const row = Math.floor(index / num2);
                const col = index % num2;
                const isInSelection = isSelecting && row <= selectionEnd.row && col <= selectionEnd.col;
                const isVisible = index < currentCount || (!isAnimating && currentCount === 0);
                
                if (isInSelection && !isAnimating) {
                    return 'bg-orange-300 border-orange-400 shadow-md';
                }
                
                if (!isVisible) return 'bg-gray-100 border-gray-200';
                
                if (colorMode === 'fill') {
                    return 'bg-blue-400 border-blue-500';
                } else if (colorMode === 'rainbow') {
                    const colors = [
                        'bg-red-400 border-red-500',
                        'bg-orange-400 border-orange-500',
                        'bg-yellow-400 border-yellow-500',
                        'bg-green-400 border-green-500',
                        'bg-blue-400 border-blue-500',
                        'bg-indigo-400 border-indigo-500',
                        'bg-purple-400 border-purple-500'
                    ];
                    return colors[index % colors.length];
                } else {
                    const colors = [
                        'bg-red-300 border-red-400',
                        'bg-blue-300 border-blue-400',
                        'bg-green-300 border-green-400',
                        'bg-yellow-300 border-yellow-400',
                        'bg-purple-300 border-purple-400',
                        'bg-pink-300 border-pink-400',
                        'bg-indigo-300 border-indigo-400'
                    ];
                    return colors[row % colors.length];
                }
            };

            const getCellBorderStyle = (index) => {
                const row = Math.floor(index / num2);
                const col = index % num2;
                
                let borderStyle = '';
                
                if (num2 > 10 && col === 9) {
                    borderStyle += ' border-r-4 border-r-black';
                }
                
                if (num1 > 10 && row === 9) {
                    borderStyle += ' border-b-4 border-b-black';
                }
                
                return borderStyle;
            };

            const handleCellMouseDown = (index) => {
                if (isAnimating) return;
                const row = Math.floor(index / num2);
                const col = index % num2;
                setSelectionEnd({ row, col });
                setIsSelecting(true);
                setIsDragging(true);
            };

            const handleCellMouseEnter = (index) => {
                if (isDragging && !isAnimating) {
                    const row = Math.floor(index / num2);
                    const col = index % num2;
                    setSelectionEnd({ row, col });
                }
            };

            const handleMouseUp = () => {
                setIsDragging(false);
            };

            const clearSelection = () => {
                setIsSelecting(false);
                setSelectionEnd({ row: 0, col: 0 });
            };

            useEffect(() => {
                document.addEventListener('mouseup', handleMouseUp);
                return () => document.removeEventListener('mouseup', handleMouseUp);
            }, []);

            const renderGrid = () => {
                const cells = [];
                let selectionCounter = 1;
                
                for (let i = 0; i < num1 * num2; i++) {
                    const row = Math.floor(i / num2);
                    const col = i % num2;
                    const isInSelection = isSelecting && row <= selectionEnd.row && col <= selectionEnd.col;
                    const isVisible = i < currentCount || (!isAnimating && currentCount === 0);
                    const showCellNumber = showNumbers && isVisible && (isInSelection || isAnimating);
                    
                    let cellNumber = i + 1;
                    if (isInSelection && !isAnimating) {
                        cellNumber = selectionCounter++;
                    }
                    
                    cells.push(
                        React.createElement('div', {
                            key: i,
                            className: `border-2 transition-all duration-200 flex items-center justify-center text-xs font-bold cursor-pointer select-none ${getCellColor(i)} ${getCellBorderStyle(i)}`,
                            style: {
                                width: cellSize,
                                height: cellSize,
                                fontSize: cellSize < 25 ? '8px' : '10px'
                            },
                            onMouseDown: () => handleCellMouseDown(i),
                            onMouseEnter: () => handleCellMouseEnter(i)
                        }, showCellNumber ? cellNumber : '')
                    );
                }
                return cells;
            };

            return React.createElement('div', {
                className: "min-h-screen bg-gradient-to-br from-indigo-50 to-purple-100 p-4"
            },
                React.createElement('div', { className: "max-w-6xl mx-auto" },
                    // Header
                    React.createElement('div', { className: "text-center mb-8" },
                        React.createElement('h1', { className: "text-4xl font-bold text-indigo-800 mb-2" }, "Multiplication Rectangle Visualizer"),
                        React.createElement('p', { className: "text-indigo-600" }, "See multiplication as arrays of unit cells")
                    ),
                    
                    // Controls
                    React.createElement('div', { className: "bg-white rounded-lg p-6 shadow-md mb-6" },
                        React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6" },
                            // Number inputs
                            React.createElement('div', null,
                                React.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2" }, "First Number"),
                                React.createElement('input', {
                                    type: "number",
                                    min: "1",
                                    max: maxSize,
                                    value: num1,
                                    onChange: (e) => {
                                        const val = Math.min(maxSize, Math.max(1, parseInt(e.target.value) || 1));
                                        setNum1(val);
                                        resetAnimation();
                                    },
                                    className: "w-full p-2 border border-gray-300 rounded-lg focus:border-indigo-500 focus:outline-none"
                                })
                            ),
                            React.createElement('div', null,
                                React.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2" }, "Second Number"),
                                React.createElement('input', {
                                    type: "number",
                                    min: "1",
                                    max: maxSize,
                                    value: num2,
                                    onChange: (e) => {
                                        const val = Math.min(maxSize, Math.max(1, parseInt(e.target.value) || 1));
                                        setNum2(val);
                                        resetAnimation();
                                    },
                                    className: "w-full p-2 border border-gray-300 rounded-lg focus:border-indigo-500 focus:outline-none"
                                })
                            ),
                            // Speed
                            React.createElement('div', null,
                                React.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2" }, "Speed"),
                                React.createElement('select', {
                                    value: animationSpeed,
                                    onChange: (e) => setAnimationSpeed(parseInt(e.target.value)),
                                    className: "w-full p-2 border border-gray-300 rounded-lg focus:border-indigo-500 focus:outline-none"
                                },
                                    React.createElement('option', { value: 50 }, "Fast"),
                                    React.createElement('option', { value: 100 }, "Medium"),
                                    React.createElement('option', { value: 200 }, "Slow")
                                )
                            ),
                            // Color Mode
                            React.createElement('div', null,
                                React.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2" }, "Color Mode"),
                                React.createElement('select', {
                                    value: colorMode,
                                    onChange: (e) => setColorMode(e.target.value),
                                    className: "w-full p-2 border border-gray-300 rounded-lg focus:border-indigo-500 focus:outline-none"
                                },
                                    React.createElement('option', { value: "fill" }, "Solid Blue"),
                                    React.createElement('option', { value: "rows" }, "Row Colors"),
                                    React.createElement('option', { value: "rainbow" }, "Rainbow")
                                )
                            )
                        ),
                        
                        // Action Buttons
                        React.createElement('div', { className: "flex flex-wrap gap-3 mt-6" },
                            React.createElement('button', {
                                onClick: startAnimation,
                                className: "bg-green-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-green-700 transition-colors flex items-center gap-2"
                            }, React.createElement(Play), "Start"),
                            
                            React.createElement('button', {
                                onClick: toggleAnimation,
                                className: "bg-blue-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center gap-2"
                            }, isAnimating ? React.createElement(Pause) : React.createElement(Play), isAnimating ? 'Pause' : 'Resume'),
                            
                            React.createElement('button', {
                                onClick: showAll,
                                className: "bg-purple-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-purple-700 transition-colors"
                            }, "Show All"),
                            
                            React.createElement('button', {
                                onClick: resetAnimation,
                                className: "bg-gray-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-gray-700 transition-colors flex items-center gap-2"
                            }, React.createElement(RotateCcw), "Reset"),
                            
                            React.createElement('button', {
                                onClick: clearSelection,
                                className: "bg-orange-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-orange-700 transition-colors"
                            }, "Clear Selection"),
                            
                            React.createElement('button', {
                                onClick: () => setShowNumbers(!showNumbers),
                                className: "bg-indigo-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-indigo-700 transition-colors flex items-center gap-2"
                            }, showNumbers ? React.createElement(EyeOff) : React.createElement(Eye), showNumbers ? 'Hide' : 'Show', " Numbers")
                        )
                    ),
                    
                    // Equation Display
                    React.createElement('div', { className: "text-center mb-6" },
                        React.createElement('div', { className: "bg-white rounded-lg p-6 shadow-md inline-block" },
                            React.createElement('div', { className: "text-3xl font-bold text-gray-800 mb-2" }, `${num1} × ${num2} = ${num1 * num2}`),
                            React.createElement('div', { className: "text-lg text-gray-600 mt-2" }, `${num1} rows × ${num2} columns = ${currentCount > 0 ? currentCount : num1 * num2} unit cells`),
                            isSelecting && React.createElement('div', { className: "text-lg text-orange-600 mt-2 p-2 bg-orange-50 rounded" }, `Selected: ${selectionEnd.row + 1} × ${selectionEnd.col + 1} = ${(selectionEnd.row + 1) * (selectionEnd.col + 1)} cells`),
                            isAnimating && React.createElement('div', { className: "text-sm text-blue-600 mt-2" }, `Counting: ${currentCount} / ${num1 * num2}`)
                        )
                    ),
                    
                    // Grid Visualization
                    React.createElement('div', { className: "bg-white rounded-lg p-6 shadow-md" },
                        React.createElement('div', { className: "flex justify-center" },
                            React.createElement('div', { className: "inline-block" },
                                // Top numbers
                                React.createElement('div', { 
                                    className: "flex mb-2", 
                                    style: { marginLeft: cellSize * 0.8 + 8 + 16 } 
                                },
                                    Array.from({length: num2}, (_, i) => 
                                        React.createElement('div', {
                                            key: i,
                                            className: "flex items-center justify-center font-bold text-indigo-600",
                                            style: { 
                                                width: cellSize,
                                                height: cellSize * 0.6,
                                                fontSize: cellSize < 25 ? '12px' : '14px',
                                                marginRight: '4px'
                                            }
                                        }, i + 1)
                                    )
                                ),
                                
                                // Grid with left numbers
                                React.createElement('div', { className: "flex" },
                                    // Left numbers
                                    React.createElement('div', { 
                                        className: "flex flex-col", 
                                        style: { marginRight: '8px', paddingTop: '16px' } 
                                    },
                                        Array.from({length: num1}, (_, i) => 
                                            React.createElement('div', {
                                                key: i,
                                                className: "flex items-center justify-center font-bold text-indigo-600",
                                                style: { 
                                                    width: cellSize * 0.8,
                                                    height: cellSize,
                                                    fontSize: cellSize < 25 ? '12px' : '14px',
                                                    marginBottom: '4px'
                                                }
                                            }, i + 1)
                                        )
                                    ),
                                    
                                    // Main grid
                                    React.createElement('div', {
                                        className: "grid p-4 bg-gray-50 rounded-lg",
                                        style: { 
                                            gridTemplateColumns: `repeat(${num2}, 1fr)`,
                                            gap: '4px',
                                            maxWidth: '80vw',
                                            overflow: 'auto'
                                        }
                                    }, ...renderGrid())
                                )
                            )
                        ),
                        
                        // Dimension Labels
                        React.createElement('div', { className: "mt-4 text-center text-sm text-gray-600" },
                            React.createElement('div', { className: "mb-2" },
                                React.createElement('span', { className: "inline-block bg-blue-100 px-3 py-1 rounded-full mr-4" }, `Width: ${num2} units`),
                                React.createElement('span', { className: "inline-block bg-green-100 px-3 py-1 rounded-full" }, `Height: ${num1} units`)
                            ),
                            React.createElement('div', { className: "text-xs text-gray-500" }, "Each small square represents one unit. Count them all to get the product!")
                        )
                    )
                )
            );
        };

        ReactDOM.render(React.createElement(MultiplicationVisualizer), document.getElementById('root'));
    </script>
</body>
</html>